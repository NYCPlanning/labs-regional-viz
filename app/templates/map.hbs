{{#map-from-id
  narrativeVisible=narrativeVisible
  toggleNarrative=(action 'toggleNarrative')
  mapConfig=model.map
  as |map|
}}

  {{supporting-layers map=map.mapboxGl}}
{{/map-from-id}}

{{#if narrativeVisible}}
  <a {{action 'toggleNarrative'}} class="narrative-toggle">
    <span>{{fa-icon 'times'}}</span>
  </a>
  <div class="cell large-5 xlarge-4 narrative-container">

    <h1 class="header-xlarge narrative-title">{{model.title}}</h1>

    {{md-text text=model.content html=true}}

    {{#if model.source}}
      <hr>
      <p class="text-small dark-gray">{{model.source}}</p>
    {{/if}}

    {{outlet}}

    {{#if model.isLinearNarrative}}
      <nav class="narrative-navigation text-center">
        {{#if model.transitionPrompt}}
          <p class="narrative-transition-prompt">{{model.transitionPrompt}}</p>
        {{/if}}

        {{#link-to 'map' previousNarrative.categorySlug previousNarrative.slug class=(if previousNarrative 'button tiny gray text-orange' 'button tiny gray text-orange disabled')}}
          {{fa-icon 'arrow-left'}}
        {{/link-to}}

        {{#link-to 'map' nextNarrative.categorySlug nextNarrative.slug class=(if nextNarrative 'button' 'button disabled')}}
          Next&nbsp;&nbsp;{{fa-icon 'arrow-right'}}
        {{/link-to}}
      </nav>
    {{/if}}

  </div>
{{/if}}

{{outlet}}
